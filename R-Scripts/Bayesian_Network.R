library(readxl)
library(bnlearn)
data1 = RTM_2020_Cat_Agg
data2 = lapply(data1, as.factor)
data3 = data.frame(data2)
pdag = hc(data3)
pdag
plot(pdag)
dag = set.arc(pdag, from = "Vehicle_Cat", to = "Average_Intensity")
dag1 = set.arc(dag, from = "Time.of.the.day", to = "Average_Time")
dag2 = set.arc(dag1, from = "Time.of.the.day", to = "Average_Intensity")
dag3 = drop.arc(dag2, from = "Day.in.a.week", to = "Average_Speed")
dag4 = drop.arc(dag3, from = "Day.in.a.week", to = "Week.Day.Week.End")
dag5 = set.arc(dag4, from = "Day.in.a.week", to ="Average_Speed")
dag6 = set.arc(dag5, from = "Week.Day.Week.End", to = "Average_Time")
dag7 = set.arc(dag6, from = "Average_Time", to = "Average_Intensity")
dag8 = set.arc(dag7, from = "Average_Time", to = "Average_Speed")
dag9 = set.arc(dag8, from = "Average_Speed", to = "Average_Intensity")
dag10 = drop.arc(dag9, from = "Day.in.a.week", to = "Average_Intensity")
getOption("max.print")
dag10
plot(dag10)
score(dag10, data3, type = "bic")
score(dag10, data3, type ="aic")
score(dag10, data3, type="bde")
score(dag10, data3, type="k2")

fit = bn.fit(dag10, data3)
print(fit$Day.in.a.week)
print(fit$Week.Day.Week.End)
print(fit$Time.of.the.day)
print(fit$Average_Speed)
print(fit$Average_Time)
print(fit$Average_Intensity)
print(fit$Vehicle_Cat)
fit
cpquery(fit, event = (Average_Time =="High"), evidence = (Average_Speed=="High"))
cpquery(fit, event = (Average_Intensity =="High"), evidence = (Average_Speed=="Low" & Average_Time =="High"))
bn.cv(data3, bn ="iamb", k =5)

# Hill climbing Algorithm
data3 = data.frame(data2)
pdag1 = hc(data3)
pdag1
plot(pdag1)
pdag1 = set.arc(pdag1, from = "Vehicle_Cat", to = "Average_Intensity")
plot(pdag1)
score(pdag1, data3, type = "bic")
score(pdag1, data3, type ="aic")
score(pdag1, data3, type="bde")
score(pdag1, data3, type="k2")