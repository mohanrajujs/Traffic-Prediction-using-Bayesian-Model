library(readxl)
Time_Wise_2020_D1_Cont <- read_excel("F:/MSC_Research/12.Final_Submission/Analysis/Results_Amsterdam/Time_Wise_2020_D1_Cont.xlsx")
View(Time_Wise_2020_D1_Cont)
library(readxl)
library(bnlearn)
library(forecast)
data1 = RTM_2020_Cont_Agg
data3 = data.frame(data1)
abc = data3[1:375, ]
def = data3[376:743, ]
pdag = hc(abc)
pdag
plot(pdag)
library(readxl)
library(bnlearn)
library(forecast)
data1 = Time_Wise_2020_D1_Cont
data3 = data.frame(data1)
abc = data3[1:375, ]
def = data3[376:743, ]
pdag = hc(abc)
pdag
plot(pdag)
dag = set.arc(pdag, from = "Vehicle_Cat", to = "Average_Intensity")
dag2 = set.arc(dag, from = "Time.of.the.day", to = "Average_Intensity")
dag3 = drop.arc(dag2, from = "Day.in.a.week", to = "Average_Speed")
dag4 = drop.arc(dag3, from = "Day.in.a.week", to = "Week_Day_Week_End")
dag5 = set.arc(dag4, from = "Day.in.a.week", to ="Average_Speed")
dag6 = set.arc(dag5, from = "Week_Day_Week_End", to = "Average_Time")
dag7 = set.arc(dag6, from = "Average_Time", to = "Average_Intensity")
dag8 = set.arc(dag7, from = "Average_Time", to = "Average_Speed")
dag9 = set.arc(dag8, from = "Average_Speed", to = "Average_Intensity")
options(max.print=1000000)
dag9
plot(dag9)
library(readxl)
library(bnlearn)
library(forecast)
data1 = Time_Wise_2020_D1_Cont
data3 = data.frame(data1)
abc = data3[1:375, ]
def = data3[376:743, ]
pdag = hc(abc)
pdag
plot(pdag)
dag = set.arc(pdag, from = "Vehicle_Cat", to = "Average_Intensity")
dag2 = set.arc(dag, from = "Time.of.the.day", to = "Average_Intensity")
dag3 = drop.arc(dag2, from = "Day.in.a.week", to = "Average_Speed")
dag4 = drop.arc(dag3, from = "Day.in.a.week", to = "Week_Day_Week_End")
dag5 = set.arc(dag4, from = "Day.in.a.week", to ="Average_Speed")
dag6 = set.arc(dag5, from = "Week_Day_Week_End", to = "Average_Time")
dag7 = set.arc(dag6, from = "Average_Time", to = "Average_Intensity")
dag8 = set.arc(dag7, from = "Average_Time", to = "Average_Speed")
dag9 = set.arc(dag8, from = "Average_Speed", to = "Average_Intensity")
options(max.print=1000000)
dag9
library(readxl)
Time_Wise_2020_D1_Cont <- read_excel("F:/MSC_Research/12.Final_Submission/Analysis/Results_Amsterdam/Time_Wise_2020_D1_Cont.xlsx")
View(Time_Wise_2020_D1_Cont)
library(readxl)
library(bnlearn)
library(forecast)
data1 = Time_Wise_2020_D1_Cont
data3 = data.frame(data1)
abc = data3[1:375, ]
def = data3[376:743, ]
pdag = hc(abc)
pdag
plot(pdag)
dag = set.arc(pdag, from = "Vehicle_Cat", to = "Average_Intensity")
dag2 = set.arc(dag, from = "Time.of.the.day", to = "Average_Intensity")
dag3 = drop.arc(dag2, from = "Day.in.a.week", to = "Average_Speed")
dag4 = drop.arc(dag3, from = "Day.in.a.week", to = "Week_Day_Week_End")
dag5 = set.arc(dag4, from = "Day.in.a.week", to ="Average_Speed")
dag6 = set.arc(dag5, from = "Week_Day_Week_End", to = "Average_Time")
dag7 = set.arc(dag6, from = "Average_Time", to = "Average_Intensity")
dag8 = set.arc(dag7, from = "Average_Time", to = "Average_Speed")
dag9 = set.arc(dag8, from = "Average_Speed", to = "Average_Intensity")
options(max.print=1000000)
dag9
plot(dag9)
fitttted = bn.fit(dag9, abc)
pred = predict(fitttted, "Average_Intensity", def)
cbind(predicted =pred, actual = def[, "Average_Intensity"])
accuracy(forecast(pred))
library(readxl)
library(bnlearn)
library(forecast)
data1 = Time_Wise_2020_D1_Cont
data3 = data.frame(data1)
abc = data3[1:500, ]
def = data3[500:743, ]
pdag = hc(abc)
pdag
plot(pdag)
dag = set.arc(pdag, from = "Vehicle_Cat", to = "Average_Intensity")
dag2 = set.arc(dag, from = "Time.of.the.day", to = "Average_Intensity")
dag3 = drop.arc(dag2, from = "Day.in.a.week", to = "Average_Speed")
dag4 = drop.arc(dag3, from = "Day.in.a.week", to = "Week_Day_Week_End")
dag5 = set.arc(dag4, from = "Day.in.a.week", to ="Average_Speed")
dag6 = set.arc(dag5, from = "Week_Day_Week_End", to = "Average_Time")
dag7 = set.arc(dag6, from = "Average_Time", to = "Average_Intensity")
dag8 = set.arc(dag7, from = "Average_Time", to = "Average_Speed")
dag9 = set.arc(dag8, from = "Average_Speed", to = "Average_Intensity")
options(max.print=1000000)
dag9
plot(dag9)
fitttted = bn.fit(dag9, abc)
pred = predict(fitttted, "Average_Intensity", def)
#cbind(pred, def[, "Average_Intensity"])
cbind(predicted =pred, actual = def[, "Average_Intensity"])
accuracy(forecast(pred))
library(readxl)
library(bnlearn)
library(forecast)
data1 = Time_Wise_2020_D1_Cont
data3 = data.frame(data1)
abc = data3[1:375, ]
def = data3[376:743, ]
pdag = hc(abc)
pdag
plot(pdag)
dag = set.arc(pdag, from = "Vehicle_Cat", to = "Average_Intensity")
dag2 = set.arc(dag, from = "Time.of.the.day", to = "Average_Intensity")
dag3 = drop.arc(dag2, from = "Day.in.a.week", to = "Average_Speed")
dag4 = drop.arc(dag3, from = "Day.in.a.week", to = "Week_Day_Week_End")
dag5 = set.arc(dag4, from = "Day.in.a.week", to ="Average_Speed")
dag6 = set.arc(dag5, from = "Week_Day_Week_End", to = "Average_Time")
dag7 = set.arc(dag6, from = "Average_Time", to = "Average_Intensity")
dag8 = set.arc(dag7, from = "Average_Time", to = "Average_Speed")
dag9 = set.arc(dag8, from = "Average_Speed", to = "Average_Intensity")
options(max.print=1000000)
dag9
plot(dag9)
fitttted = bn.fit(dag9, abc)
pred = predict(fitttted, "Average_Intensity", def)
#cbind(pred, def[, "Average_Intensity"])
cbind(predicted =pred, actual = def[, "Average_Intensity"])
accuracy(forecast(pred))
library(readxl)
library(bnlearn)
library(forecast)
data1 = Time_Wise_2020_D1_Cont
data3 = data.frame(data1)
abc = data3[1:200, ]
def = data3[201:743, ]
pdag = hc(abc)
pdag
plot(pdag)
dag = set.arc(pdag, from = "Vehicle_Cat", to = "Average_Intensity")
dag2 = set.arc(dag, from = "Time.of.the.day", to = "Average_Intensity")
dag3 = drop.arc(dag2, from = "Day.in.a.week", to = "Average_Speed")
dag4 = drop.arc(dag3, from = "Day.in.a.week", to = "Week_Day_Week_End")
dag5 = set.arc(dag4, from = "Day.in.a.week", to ="Average_Speed")
dag6 = set.arc(dag5, from = "Week_Day_Week_End", to = "Average_Time")
dag7 = set.arc(dag6, from = "Average_Time", to = "Average_Intensity")
dag8 = set.arc(dag7, from = "Average_Time", to = "Average_Speed")
dag9 = set.arc(dag8, from = "Average_Speed", to = "Average_Intensity")
options(max.print=1000000)
dag9
plot(dag9)
fitttted = bn.fit(dag9, abc)
pred = predict(fitttted, "Average_Intensity", def)
#cbind(pred, def[, "Average_Intensity"])
cbind(predicted =pred, actual = def[, "Average_Intensity"])
accuracy(forecast(pred))
library(readxl)
RTM_2020_Cont_Agg <- read_excel("F:/MSC_Research/12.Final_Submission/Analysis/Results_Rotterdam/RTM_2020_Cont_Agg.xlsx")
View(RTM_2020_Cont_Agg)
library(readxl)
library(bnlearn)
library(forecast)
library(readxl)
library(bnlearn)
library(forecast)
data1 = RTM_2020_Cont_Agg
data3 = data.frame(data1)
abc = data3[1:200, ]
def = data3[201:743, ]
pdag = hc(abc)
pdag
plot(pdag)
dag = set.arc(pdag, from = "Vehicle_Cat", to = "Average_Intensity")
dag2 = set.arc(dag, from = "Time.of.the.day", to = "Average_Intensity")
dag3 = drop.arc(dag2, from = "Day.in.a.week", to = "Average_Speed")
dag4 = drop.arc(dag3, from = "Day.in.a.week", to = "Week_Day_Week_End")
dag5 = set.arc(dag4, from = "Day.in.a.week", to ="Average_Speed")
dag6 = set.arc(dag5, from = "Week_Day_Week_End", to = "Average_Time")
dag7 = set.arc(dag6, from = "Average_Time", to = "Average_Intensity")
dag8 = set.arc(dag7, from = "Average_Time", to = "Average_Speed")
dag9 = set.arc(dag8, from = "Average_Speed", to = "Average_Intensity")
options(max.print=1000000)
dag9
plot(dag9)
fitttted = bn.fit(dag9, abc)
pred = predict(fitttted, "Average_Intensity", def)
#cbind(pred, def[, "Average_Intensity"])
cbind(predicted =pred, actual = def[, "Average_Intensity"])
accuracy(forecast(pred))
library(readxl)
library(bnlearn)
library(forecast)
data1 = RTM_2020_Cont_Agg
data3 = data.frame(data1)
abc = data3[1:500, ]
def = data3[501:743, ]
pdag = hc(abc)
pdag
plot(pdag)
dag = set.arc(pdag, from = "Vehicle_Cat", to = "Average_Intensity")
dag2 = set.arc(dag, from = "Time.of.the.day", to = "Average_Intensity")
dag3 = drop.arc(dag2, from = "Day.in.a.week", to = "Average_Speed")
dag4 = drop.arc(dag3, from = "Day.in.a.week", to = "Week_Day_Week_End")
dag5 = set.arc(dag4, from = "Day.in.a.week", to ="Average_Speed")
dag6 = set.arc(dag5, from = "Week_Day_Week_End", to = "Average_Time")
dag7 = set.arc(dag6, from = "Average_Time", to = "Average_Intensity")
dag8 = set.arc(dag7, from = "Average_Time", to = "Average_Speed")
dag9 = set.arc(dag8, from = "Average_Speed", to = "Average_Intensity")
options(max.print=1000000)
dag9
plot(dag9)
fitttted = bn.fit(dag9, abc)
pred = predict(fitttted, "Average_Intensity", def)
#cbind(pred, def[, "Average_Intensity"])
cbind(predicted =pred, actual = def[, "Average_Intensity"])
accuracy(forecast(pred))
library(readxl)
RTM_2018_Cont_Agg <- read_excel("F:/MSC_Research/12.Final_Submission/Analysis/Results_Rotterdam/RTM_2018_Cont_Agg.xlsx")
View(RTM_2018_Cont_Agg)
library(readxl)
library(bnlearn)
library(forecast)
data1 = RTM_2020_Cont_Agg
data3 = data.frame(data1)
abc = data3[1:500, ]
def = data3[501:743, ]
pdag = hc(abc)
pdag
plot(pdag)
dag = set.arc(pdag, from = "Vehicle_Cat", to = "Average_Intensity")
dag2 = set.arc(dag, from = "Time.of.the.day", to = "Average_Intensity")
dag3 = drop.arc(dag2, from = "Day.in.a.week", to = "Average_Speed")
dag4 = drop.arc(dag3, from = "Day.in.a.week", to = "Week_Day_Week_End")
dag5 = set.arc(dag4, from = "Day.in.a.week", to ="Average_Speed")
dag6 = set.arc(dag5, from = "Week_Day_Week_End", to = "Average_Time")
dag7 = set.arc(dag6, from = "Average_Time", to = "Average_Intensity")
dag8 = set.arc(dag7, from = "Average_Time", to = "Average_Speed")
dag9 = set.arc(dag8, from = "Average_Speed", to = "Average_Intensity")
options(max.print=1000000)
dag9
plot(dag9)
fitttted = bn.fit(dag9, abc)
pred = predict(fitttted, "Average_Intensity", def)
#cbind(pred, def[, "Average_Intensity"])
cbind(predicted =pred, actual = def[, "Average_Intensity"])
accuracy(forecast(pred))
library(readxl)
library(bnlearn)
library(forecast)
data1 = RTM_2018_Cont_Agg
data3 = data.frame(data1)
abc = data3[1:500, ]
def = data3[501:743, ]
pdag = hc(abc)
pdag
plot(pdag)
dag = set.arc(pdag, from = "Vehicle_Cat", to = "Average_Intensity")
dag2 = set.arc(dag, from = "Time.of.the.day", to = "Average_Intensity")
dag3 = drop.arc(dag2, from = "Day.in.a.week", to = "Average_Speed")
dag4 = drop.arc(dag3, from = "Day.in.a.week", to = "Week_Day_Week_End")
dag5 = set.arc(dag4, from = "Day.in.a.week", to ="Average_Speed")
dag6 = set.arc(dag5, from = "Week_Day_Week_End", to = "Average_Time")
dag7 = set.arc(dag6, from = "Average_Time", to = "Average_Intensity")
dag8 = set.arc(dag7, from = "Average_Time", to = "Average_Speed")
dag9 = set.arc(dag8, from = "Average_Speed", to = "Average_Intensity")
options(max.print=1000000)
dag9
plot(dag9)
fitttted = bn.fit(dag9, abc)
pred = predict(fitttted, "Average_Intensity", def)
#cbind(pred, def[, "Average_Intensity"])
cbind(predicted =pred, actual = def[, "Average_Intensity"])
accuracy(forecast(pred))
library(readxl)
library(bnlearn)
library(forecast)
data1 = RTM_2018_Cont_Agg
data3 = data.frame(data1)
abc = data3[1:200, ]
def = data3[201:743, ]
pdag = hc(abc)
pdag
plot(pdag)
dag = set.arc(pdag, from = "Vehicle_Cat", to = "Average_Intensity")
dag2 = set.arc(dag, from = "Time.of.the.day", to = "Average_Intensity")
dag3 = drop.arc(dag2, from = "Day.in.a.week", to = "Average_Speed")
dag4 = drop.arc(dag3, from = "Day.in.a.week", to = "Week_Day_Week_End")
dag5 = set.arc(dag4, from = "Day.in.a.week", to ="Average_Speed")
dag6 = set.arc(dag5, from = "Week_Day_Week_End", to = "Average_Time")
dag7 = set.arc(dag6, from = "Average_Time", to = "Average_Intensity")
dag8 = set.arc(dag7, from = "Average_Time", to = "Average_Speed")
dag9 = set.arc(dag8, from = "Average_Speed", to = "Average_Intensity")
options(max.print=1000000)
dag9
plot(dag9)
fitttted = bn.fit(dag9, abc)
pred = predict(fitttted, "Average_Intensity", def)
#cbind(pred, def[, "Average_Intensity"])
cbind(predicted =pred, actual = def[, "Average_Intensity"])
accuracy(forecast(pred))
library(readxl)
Time_Wise_2018_D1_aggregated <- read_excel("F:/MSC_Research/12.Final_Submission/Analysis/Results_Amsterdam/Time_Wise_2018_D1_aggregated.xlsx")
View(Time_Wise_2018_D1_aggregated)
library(readxl)
library(bnlearn)
library(forecast)
data1 = Time_Wise_2018_D1_aggregated
data3 = data.frame(data1)
abc = data3[1:200, ]
def = data3[201:743, ]
pdag = hc(abc)
pdag
plot(pdag)
dag = set.arc(pdag, from = "Vehicle_Cat", to = "Average_Intensity")
dag2 = set.arc(dag, from = "Time.of.the.day", to = "Average_Intensity")
dag3 = drop.arc(dag2, from = "Day.in.a.week", to = "Average_Speed")
dag4 = drop.arc(dag3, from = "Day.in.a.week", to = "Week_Day_Week_End")
dag5 = set.arc(dag4, from = "Day.in.a.week", to ="Average_Speed")
dag6 = set.arc(dag5, from = "Week_Day_Week_End", to = "Average_Time")
dag7 = set.arc(dag6, from = "Average_Time", to = "Average_Intensity")
dag8 = set.arc(dag7, from = "Average_Time", to = "Average_Speed")
dag9 = set.arc(dag8, from = "Average_Speed", to = "Average_Intensity")
options(max.print=1000000)
dag9
plot(dag9)
fitttted = bn.fit(dag9, abc)
pred = predict(fitttted, "Average_Intensity", def)
#cbind(pred, def[, "Average_Intensity"])
cbind(predicted =pred, actual = def[, "Average_Intensity"])
accuracy(forecast(pred))
library(readxl)
library(bnlearn)
library(forecast)
data1 = Time_Wise_2018_D1_aggregated
data3 = data.frame(data1)
abc = data3[1:500, ]
def = data3[501:743, ]
pdag = hc(abc)
pdag
plot(pdag)
dag = set.arc(pdag, from = "Vehicle_Cat", to = "Average_Intensity")
dag2 = set.arc(dag, from = "Time.of.the.day", to = "Average_Intensity")
dag3 = drop.arc(dag2, from = "Day.in.a.week", to = "Average_Speed")
dag4 = drop.arc(dag3, from = "Day.in.a.week", to = "Week_Day_Week_End")
dag5 = set.arc(dag4, from = "Day.in.a.week", to ="Average_Speed")
dag6 = set.arc(dag5, from = "Week_Day_Week_End", to = "Average_Time")
dag7 = set.arc(dag6, from = "Average_Time", to = "Average_Intensity")
dag8 = set.arc(dag7, from = "Average_Time", to = "Average_Speed")
dag9 = set.arc(dag8, from = "Average_Speed", to = "Average_Intensity")
options(max.print=1000000)
dag9
plot(dag9)
fitttted = bn.fit(dag9, abc)
pred = predict(fitttted, "Average_Intensity", def)
#cbind(pred, def[, "Average_Intensity"])
cbind(predicted =pred, actual = def[, "Average_Intensity"])
accuracy(forecast(pred))
