library(readxl)
library(bnlearn)
data1 = Sensorwise_2018_D2_Categorical
data2 = lapply(data1, as.factor)
data3 = data.frame(data2)
pdag = iamb(data3)
pdag
plot(pdag)
dag = set.arc(pdag, from = "Vehicle_Category_Coding", to = "Average_intensity")
dag1 = set.arc(dag, from = "Average_time", to = "Average_Speed")
dag2 = drop.arc(dag1, from = "Clustering", to = "Average_Speed")
dag3 = drop.arc(dag2, from = "Clustering", to ="Average_Speed")
dag4 = drop.arc(dag3, from = "Average_intensity", to = "Average_Speed")
dag5 = set.arc(dag4, from = "Average_time", to = "Average_Speed")
dag6 = set.arc(dag5, from = "Clustering", to = "Average_intensity")
dag7 = set.arc(dag6, from = "Average_Speed", to = "Average_intensity")
plot(dag7)
dag7
fit = bn.fit(dag7, data3)
print(fit$Clustering)
print(fit$Average_intensity)
print(fit$Average_time)
print(fit$Average_Speed)
print(fit$Vehicle_Category_Coding)